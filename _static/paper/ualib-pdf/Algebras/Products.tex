%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Product algebra type}\label{ssec:product-algebra-type}
%% This section describes some parts of the \ualibAlgProducts module of the \agdaualib.
Suppose we are given a type \ab I \as : \ab 𝓘 (of ``indices'') and an indexed family \ab 𝒜 \as : \ab I \as → \af{Algebra} \ab 𝓤 \ab 𝑆 of \ab 𝑆-algebras. Then we define the \emph{product algebra}
\AgdaFunction{⨅} \AgdaBound{𝒜}
in the following natural way.%
%
\footnote{To distinguish the product algebra from the standard product type available in the \agdastdlib, instead of \af ∏ (\texttt{\textbackslash prod}) or \af Π (\texttt{\textbackslash Pi}), we use the symbol \AgdaFunction{⨅}, which is typed in \agdamode as \texttt{\textbackslash Glb}.}%
%
\ccpad
\begin{code}%
\>[1]\AgdaFunction{⨅}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{𝓘}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{̇}}\AgdaSpace{}%
\AgdaSymbol{\}(}\AgdaBound{𝒜}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{𝓤}\AgdaSpace{}%
\AgdaBound{𝑆}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{𝓘}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{𝓤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{𝑆}\<%
\\
%
\>[1]\AgdaFunction{⨅}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{𝒜}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
\AgdaBound{𝒜}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{λ(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
\AgdaBound{𝑆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)(}\AgdaBound{𝒂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaBound{𝑆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
\AgdaBound{𝒜}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{̂}}\AgdaSpace{}%
\AgdaBound{𝒜}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{𝒂}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{\}}\<%
\end{code}
\ccpad
Here, the domain is the dependent function type
\af ∏ \af ∣ \ab 𝒜 \af ∣ := \AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}\AgdaSymbol{:}\AgdaSpace{}\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}\AgdaSymbol{→}\AgdaSpace{}\AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}\AgdaBound{𝒜}\AgdaSpace{}\AgdaBound{i}\AgdaSpace{}\AgdaOperator{\AgdaFunction{∣}}
of ``tuples'', the \ab i-th components of which live in \af ∣ \ab 𝒜 \ab i \af ∣, and the operations are simply the operations of the \ab 𝒜~\ab i, interpreted component-wise.

The Birkhoff theorem involves products of entire arbitrary (nonindexed) classes of algebras, and it is not obvious how to handle this constructively, or whether it is even possible to do so without making extra assumptions about the class. (See~\cite{Carlstrom:2008} for a discussion of this issue.)  We describe our solution to this problem in \S\ref{sssec:products-of-classes}.


%% We define products of algebras for both the Sigma type representation (the one we use most often) and the record type representation.
%% \ccpad
%% \begin{code}%
%% \>[0]\AgdaKeyword{module}\AgdaSpace{}%
%% \AgdaModule{UALib.Algebras.Products}\AgdaSpace{}%
%% \AgdaKeyword{where}\<%
%% \\
%% %
%% \ccpad
%% %
%% \>[0]\AgdaKeyword{open}\AgdaSpace{}%
%% \AgdaKeyword{import}\AgdaSpace{}%
%% \AgdaModule{UALib.Algebras.Algebras}\AgdaSpace{}%
%% \AgdaKeyword{public}\<%
%% \\
%% %
%% \ccpad
%% %
%% \>[0]\AgdaKeyword{module}\AgdaSpace{}%
%% \AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaFunction{Signature}\AgdaSpace{}%
%% \AgdaGeneralizable{𝓞}\AgdaSpace{}%
%% \AgdaGeneralizable{𝓥}\AgdaSymbol{\}}%
%% \>[44]\AgdaKeyword{where}\<%
%% \\
%% %
%% \>[0][@{}l@{\AgdaIndent{0}}]%
%% \>[1]\AgdaComment{-- product for algebras of sigma type}\<%
%% \\
%% %
%% \>[1]\AgdaFunction{⨅}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{̇}}\AgdaSpace{}%
%% \AgdaSymbol{\}(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaFunction{Algebra}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaFunction{Algebra}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaBound{𝑆}\<%
%% \\
%% %
%% \>[1]\AgdaFunction{⨅}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
%% \AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaSymbol{=}\<%
%% \\
%% \>[1][@{}l@{\AgdaIndent{0}}]%
%% \>[2]\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
%% \AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
%% \AgdaSymbol{λ(}\AgdaBound{f}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)(}\AgdaBound{𝒂}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
%% \AgdaBound{f}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
%% \AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{j}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)(}\AgdaBound{i}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{̂}}\AgdaSpace{}%
%% \AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{λ\{}\AgdaBound{x}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaBound{𝒂}\AgdaSpace{}%
%% \AgdaBound{x}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSymbol{\}}\<%
%% \\
%% %
%% \\[\AgdaEmptyExtraSkip]%
%% %
%% \>[1]\AgdaFunction{⊓}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{̇}}\AgdaSpace{}%
%% \AgdaSymbol{\}(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaFunction{Algebra}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaFunction{Algebra}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaBound{𝑆}\<%
%% \\
%% %
%% \>[1]\AgdaFunction{⊓}\AgdaSpace{}%
%% \AgdaSymbol{=}\AgdaSpace{}%
%% \AgdaFunction{⨅}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓤}\AgdaSymbol{\}}\<%
%% \\
%% %
%% \\[\AgdaEmptyExtraSkip]%
%% %
%% \>[1]\AgdaKeyword{open}\AgdaSpace{}%
%% \AgdaModule{algebra}\<%
%% \\
%% %
%% \\[\AgdaEmptyExtraSkip]%
%% %
%% \>[1]\AgdaComment{-- product for algebras of record type}\<%
%% \\
%% %
%% \>[1]\AgdaFunction{⨅'}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{̇}}\AgdaSpace{}%
%% \AgdaSymbol{\}(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaRecord{algebra}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaRecord{algebra}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{𝓘}\AgdaSpace{}%
%% \AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
%% \AgdaBound{𝓤}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaBound{𝑆}\<%
%% \\
%% %
%% \>[1]\AgdaFunction{⨅'}\AgdaSpace{}%
%% \AgdaSymbol{\{}\AgdaBound{𝓘}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
%% \AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaSymbol{=}%
%% \>[125I]\AgdaKeyword{record}\<%
%% \\
%% \>[125I][@{}l@{\AgdaIndent{0}}]%
%% \>[18]\AgdaSymbol{\{}\AgdaSpace{}%
%% \AgdaField{univ}\AgdaSpace{}%
%% \AgdaSymbol{=}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaField{univ}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSymbol{)}\<%
%% \\
%% %
%% \>[18]\AgdaSymbol{;}\AgdaSpace{}%
%% \AgdaField{op}\AgdaSpace{}%
%% \AgdaSymbol{=}%
%% \>[137I]\AgdaSymbol{λ(}\AgdaBound{f}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∣}}\AgdaSymbol{)}\<%
%% \\
%% \>[137I][@{}l@{\AgdaIndent{0}}]%
%% \>[26]\AgdaSymbol{(}\AgdaBound{𝒂}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
%% \AgdaBound{𝑆}\AgdaSpace{}%
%% \AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
%% \AgdaBound{f}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaField{univ}\AgdaSymbol{(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{j}\AgdaSymbol{))}\<%
%% \\
%% %
%% \>[26]\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
%% \AgdaSymbol{:}\AgdaSpace{}%
%% \AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaSymbol{((}\AgdaField{op}\AgdaSpace{}%
%% \AgdaSymbol{(}\AgdaBound{𝒜}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
%% \AgdaBound{f}\AgdaSymbol{)}\<%
%% \\
%% %
%% \>[26]\AgdaSymbol{λ\{}\AgdaBound{x}\AgdaSpace{}%
%% \AgdaSymbol{→}\AgdaSpace{}%
%% \AgdaBound{𝒂}\AgdaSpace{}%
%% \AgdaBound{x}\AgdaSpace{}%
%% \AgdaBound{i}\AgdaSymbol{\}}\<%
%% \\
%% %
%% \>[18]\AgdaSymbol{\}}\<%
%% \end{code}



